# -*- coding: utf-8 -*-
import google.generativeai as genai
import time
import requests
from bs4 import BeautifulSoup
from urllib.parse import quote
from selenium.webdriver.common.keys import Keys
from bs4 import BeautifulSoup   
import requests
from urllib.parse import quote

def delete_iframe(url):
    
    req = requests.get(url, headers={'User-agent': 'Mozilla/5.0'})
    soup = BeautifulSoup(req.text, "lxml")  # html에 대하여 접근할 수 있도록
    src_url =  "https://blog.naver.com/" + soup.iframe["src"]

    return src_url

def find_bolgs(my_types,city,date_day):
    
    original_string = f"{my_types} {city} {date_day - 1}박{date_day}일 일정"
    original_string = original_string.split(" ")
    encoded_string = quote(original_string[0])
    total_string = encoded_string
    for i in range(len(original_string)-1):
        encoded_string = quote(original_string[i+1])
        total_string = total_string + "+" + encoded_string

    url = f'https://search.naver.com/search.naver?where=blog&query={total_string}&sm=tab_opt&nso=so%3Ar%2Cp%3A1m'

    print(url)

    response = requests.get(url)

    url_list = []

    if response.status_code == 200:
        html = response.text
        soup = BeautifulSoup(html, 'html.parser')
        view_title = soup.select("a.title_link")
        for i in view_title:
            href = i['href']
            url_list.append(href)

    else : 
        print(response.status_code)

    return url_list

def generate_model(travel_type,city,date_Arrival,date_Departure,date_day):
    
    GOOGLE_API_KEY = ''
    genai.configure(api_key=GOOGLE_API_KEY)

    generation_config = {
      "temperature": 0,
      "top_p": 0,
      "top_k": 40,
      "max_output_tokens": 2048,
    }

  
    model = genai.GenerativeModel(model_name="gemini-pro",generation_config=generation_config)

    convo = model.start_chat(history=[
      {
        "role": "user",
        "parts": ["""앞으로 모든 여행 일정은 아래의 형식에 맞춰서 짜줘. 아래 형식이 모든 여행 일정의 가이드 라인이야.\n
        ***1일차**
        * 오전: 나리타 국제공항(NRT)에 도착하여 나리타 익스프레스 기차로 도쿄역으로 이동합니다. (1시간 30분, 3,020엔)
        * 오후: 도쿄역에서 도쿄 메트로 지하철로 도쿄 스카이 트리역으로 이동합니다. (30분, 210엔)
        * 도쿄 스카이 트리에서 도쿄의 전경을 감상합니다.
        * 도쿄 스카이 트리에서 도쿄 메트로 지하철로 아사쿠사역으로 이동합니다. (30분, 210엔)
        * 아사쿠사 신사와 나카미세 상점가를 방문합니다.
        * 저녁: 아사쿠사에서 저녁 식사를 합니다.
        * 아사쿠사에서 도쿄 메트로 지하철로 시부야역으로 이동합니다. (30분, 210엔)
        * 시부야에서 밤거리를 즐깁니다.
        * 시부야에서 도쿄 메트로 지하철로 신주쿠역으로 이동합니다. (15분, 170엔)
        * 신주쿠에서 호텔로 이동합니다.
     ***2일차**
        * 신주쿠에서 도쿄 메트로 지하철로 도쿄역으로 이동합니다. (15분, 170엔)
        * 도쿄역에서 도쿄 디즈니랜드 또는 도쿄 디즈니씨로 이동합니다. (1시간, 2,000엔)
        * 도쿄 디즈니랜드 또는 도쿄 디즈니씨에서 즐거운 시간을 보냅니다.
        * 도쿄 디즈니랜드 또는 도쿄 디즈니씨에서 도쿄역으로 이동합니다. (1시간, 2,000엔)
        * 도쿄역에서 호텔로 이동합니다.
     ***3일차**
        * 오전: 신주쿠에서 도쿄 메트로 지하철로 롯폰기역으로 이동합니다. (15분, 170엔)
        * 롯폰기 힐즈에서 도쿄의 야경을 감상합니다.
        * 오후: 롯폰기에서 도쿄 메트로 지하철로 기념품점이 많은 지역을 방문합니다. (30분, 210엔)
        * 기념품을 사기 위해 기프트샵을 방문합니다.
        * 저녁: 기념품점에서 도쿄 메트로 지하철로 신주쿠역으로 이동합니다. (30분, 210엔)
        * 신주쿠에서 저녁 식사를 합니다.
        * 신주쿠에서 호텔로 이동합니다.
     ***4일차**
        * 오전: 신주쿠에서 도쿄 메트로 지하철로 도쿄역으로 이동합니다. (15분, 170엔)
        * 도쿄역에서 나리타 익스프레스 기차로 나리타 국제공항(NRT)으로 이동합니다. (1시간 30분, 3,020엔)
        * 나리타 국제공항(NRT)에서 귀국합니다.

    도쿄 여행 팁

    * 도쿄는 대중교통이 잘 발달되어 있으므로 지하철이나 버스를 이용하면 편리하게 이동할 수 있습니다.
    * 도쿄는 물가가 비싸므로 예산을 잘 짜고 여행하는 것이 좋습니다.
    * 도쿄는 관광객이 많은 도시이므로 소지품을 잘 관리하는 것이 중요합니다.
    * 도쿄는 영어가 통하지 않는 경우가 많으므로 간단한 일본어를 배우고 가는 것이 좋습니다.

    **도쿄 이동 방법에 대한 팁**
    * 도쿄와 나리타 국제공항간 이동 : 나리타 익스пресс, 시티 라이너, 공항 림진버스를 이용할 수 있습니다.
    * 도쿄 이동 : 도쿄 도심의 주요 이동 수단은 철도, 지하철, 버스입니다. 티켓은 대부분 무인 매표기에 판매합니다. 
    * 환승 표나 패스는 티켓 센터에서 구매할 수 있습니다.
    * 패스는 1, 2, 3일 이용권이 있습니다. 1일 이용권은 1,590엔, 2일 이용권은 2,000엔, 3일 이용권은 2,500엔입니다.
    * 패스는 도쿄 도내의 모든 철도, 지하철, 버스, 도쿄만 페리를 이용할 수 있습니다.

    **도쿄의 인기 관광 명소**
    * 도쿄 타워 : 일본 최고층의 타워로 현재는 전파탑으로 쓰이고 있습니다.
    * 도쿄 디즈니랜드와 도쿄 디즈니씨 : 전 세계적으로 유명한 테마파크입니다.
    * 오다이바 : 도쿄 만에 있는 인공 섬으로 트렌디한 쇼핑몰, 레스토랑, 엔터테인먼트 시설이 있는 인기 관광 명소입니다.
    * 아사쿠사 : 도쿄의 전통적인 지역으로 나카미세 상점가, 센소지, 아사쿠사 아지마마루 쇼핑가 등이 있습니다.
    * 시부야 : 도쿄의 패션과 유흥의 중심지로 109 백화점, 하라주쿠 쇼핑가, 시부야 스크램블 교차로 등이 있습니다.
    * 신주쿠 : 도쿄의 번화가로 신주쿠 고라쿠엔, 도쿄 메트로폴리탄 정원, 신주쿠 황금가 등이 있습니다.

    **도쿄의 맛있는 음식**
    * 스시 : 도쿄는 세계적으로 유명한 스시의 본고장입니다. 츠키지 시장을 비롯한 도쿄 곳곳에서 신선한 스시를 맛볼 수 있습니다.
    * 라멘 : 라멘은 일본의 국민 음식 중 하나로, 도쿄에는 다양한 종류의 라멘집이 있습니다.
    * 돈까스 : 돈까스는 일본의 대표적인 요리 중 하나로, 튀긴 돼지고기에 소스를 뿌려 먹습니다.
    * 오코노미야키 : 오코노미야키는 일본의 팬케이크와 비슷한 음식으로, 야채, 고기, 해산물 등을 섞어 구워 먹습니다.
    * 타코야키 : 타코야키는 일본의 튀김 요리로, 밀가루 반죽에 다진 문어, 야채를 넣고 구운 것입니다.

    **도쿄의 쇼핑**
    * 긴자 : 긴자는 도쿄의 대표적인 쇼핑가로 명품 매장을 비롯한 다양한 상점이 밀집되어 있습니다.
    * 시부야 : 시부야는 도쿄의 트렌디한 쇼핑가로 패션 매장, 잡화점, 카페 등이 많이 있습니다.
    * 하라주쿠 : 하라주쿠는 도쿄의 젊은이들이 모이는 거리로 괴상한 패션과 팝 문화를 볼 수 있습니다.
    * 아사쿠사 : 아사쿠사는 도쿄의 전통적인 쇼핑가로 나카미세 상점가에서 다양한 기념품을 구입할 수 있습니다.
    * 신주쿠 : 신주쿠는 도쿄의 번화가로 백화점, 쇼핑몰, 전자상가 등이 많이 있습니다.

    **이 일정은 다음과 같은 음식을 맛볼 수 있습니다.**

    * 초밥
    * 우동
    * 돈까츠
    * 라면
    * 규카츠
    * 오코노미야키
    * 몬자야끼
    * 타코야키
    * 이자카야

    **이 일정은 다음과 같은 쇼핑을 즐길 수 있습니다.**

    * 긴자
    * 시부야
    * 신주쿠
    * 아사쿠사
    * 하라주쿠
    * 오모테산도
    * 다이칸야마


    **1일차**
    나리타 국제공항(NRT) → 도쿄역 → 도쿄 스카이 트리 → 아사쿠사신사 → 아사쿠사 → 시부야 → 신주쿠

    **2일차**
    신주쿠 → 하라주쿠 → 오모테산도 → 메이지 신궁 → 신주쿠 교엔 국립 정원 → 신주쿠 → 도쿄 디즈니랜드 또는 도쿄 디즈니씨

    **3일차**
    신주쿠 → 롯폰기 힐즈 → 기념품점 → 신주쿠

    **4일차**
    신주쿠 → 도쿄역 → 나리타 국제공항(NRT)


    **도쿄 여행 키워드**

    나리타 국제공항(NRT) → 도쿄역 → 도쿄 스카이 트리 → 아사쿠사신사 → 아사쿠사 → 시부야 → 신주쿠 → 하라주쿠 → 오모테산도 → 메이지 신궁 → 신주쿠 교엔 국립 정원 → 도쿄 디즈니랜드 또는 도쿄 디즈니씨 → 롯폰기 힐즈 → 기념품점 """]
      },
      {
        "role": "model",
        "parts": ["""

            ***1일차**
        * 오전: 나리타 국제공항(NRT)에 도착하여 나리타 익스프레스 기차로 도쿄역으로 이동합니다. (1시간 30분, 3,020엔)
        * 오후: 도쿄역에서 도쿄 메트로 지하철로 도쿄 스카이 트리역으로 이동합니다. (30분, 210엔)
        * 도쿄 스카이 트리에서 도쿄의 전경을 감상합니다.
        * 도쿄 스카이 트리에서 도쿄 메트로 지하철로 아사쿠사역으로 이동합니다. (30분, 210엔)
        * 아사쿠사 신사와 나카미세 상점가를 방문합니다.
        * 저녁: 아사쿠사에서 저녁 식사를 합니다.
        * 아사쿠사에서 도쿄 메트로 지하철로 시부야역으로 이동합니다. (30분, 210엔)
        * 시부야에서 밤거리를 즐깁니다.
        * 시부야에서 도쿄 메트로 지하철로 신주쿠역으로 이동합니다. (15분, 170엔)
        * 신주쿠에서 호텔로 이동합니다.
     ***2일차**
        * 신주쿠에서 도쿄 메트로 지하철로 도쿄역으로 이동합니다. (15분, 170엔)
        * 도쿄역에서 도쿄 디즈니랜드 또는 도쿄 디즈니씨로 이동합니다. (1시간, 2,000엔)
        * 도쿄 디즈니랜드 또는 도쿄 디즈니씨에서 즐거운 시간을 보냅니다.
        * 도쿄 디즈니랜드 또는 도쿄 디즈니씨에서 도쿄역으로 이동합니다. (1시간, 2,000엔)
        * 도쿄역에서 호텔로 이동합니다.
     ***3일차**
        * 오전: 신주쿠에서 도쿄 메트로 지하철로 롯폰기역으로 이동합니다. (15분, 170엔)
        * 롯폰기 힐즈에서 도쿄의 야경을 감상합니다.
        * 오후: 롯폰기에서 도쿄 메트로 지하철로 기념품점이 많은 지역을 방문합니다. (30분, 210엔)
        * 기념품을 사기 위해 기프트샵을 방문합니다.
        * 저녁: 기념품점에서 도쿄 메트로 지하철로 신주쿠역으로 이동합니다. (30분, 210엔)
        * 신주쿠에서 저녁 식사를 합니다.
        * 신주쿠에서 호텔로 이동합니다.
     ***4일차**
        * 오전: 신주쿠에서 도쿄 메트로 지하철로 도쿄역으로 이동합니다. (15분, 170엔)
        * 도쿄역에서 나리타 익스프레스 기차로 나리타 국제공항(NRT)으로 이동합니다. (1시간 30분, 3,020엔)
        * 나리타 국제공항(NRT)에서 귀국합니다.

    도쿄 여행 팁

    * 도쿄는 대중교통이 잘 발달되어 있으므로 지하철이나 버스를 이용하면 편리하게 이동할 수 있습니다.
    * 도쿄는 물가가 비싸므로 예산을 잘 짜고 여행하는 것이 좋습니다.
    * 도쿄는 관광객이 많은 도시이므로 소지품을 잘 관리하는 것이 중요합니다.
    * 도쿄는 영어가 통하지 않는 경우가 많으므로 간단한 일본어를 배우고 가는 것이 좋습니다.

    **도쿄 이동 방법에 대한 팁**
    * 도쿄와 나리타 국제공항간 이동 : 나리타 익스пресс, 시티 라이너, 공항 림진버스를 이용할 수 있습니다.
    * 도쿄 이동 : 도쿄 도심의 주요 이동 수단은 철도, 지하철, 버스입니다. 티켓은 대부분 무인 매표기에 판매합니다. 
    * 환승 표나 패스는 티켓 센터에서 구매할 수 있습니다.
    * 패스는 1, 2, 3일 이용권이 있습니다. 1일 이용권은 1,590엔, 2일 이용권은 2,000엔, 3일 이용권은 2,500엔입니다.
    * 패스는 도쿄 도내의 모든 철도, 지하철, 버스, 도쿄만 페리를 이용할 수 있습니다.

    **도쿄의 인기 관광 명소**
    * 도쿄 타워 : 일본 최고층의 타워로 현재는 전파탑으로 쓰이고 있습니다.
    * 도쿄 디즈니랜드와 도쿄 디즈니씨 : 전 세계적으로 유명한 테마파크입니다.
    * 오다이바 : 도쿄 만에 있는 인공 섬으로 트렌디한 쇼핑몰, 레스토랑, 엔터테인먼트 시설이 있는 인기 관광 명소입니다.
    * 아사쿠사 : 도쿄의 전통적인 지역으로 나카미세 상점가, 센소지, 아사쿠사 아지마마루 쇼핑가 등이 있습니다.
    * 시부야 : 도쿄의 패션과 유흥의 중심지로 109 백화점, 하라주쿠 쇼핑가, 시부야 스크램블 교차로 등이 있습니다.
    * 신주쿠 : 도쿄의 번화가로 신주쿠 고라쿠엔, 도쿄 메트로폴리탄 정원, 신주쿠 황금가 등이 있습니다.

    **도쿄의 맛있는 음식**
    * 스시 : 도쿄는 세계적으로 유명한 스시의 본고장입니다. 츠키지 시장을 비롯한 도쿄 곳곳에서 신선한 스시를 맛볼 수 있습니다.
    * 라멘 : 라멘은 일본의 국민 음식 중 하나로, 도쿄에는 다양한 종류의 라멘집이 있습니다.
    * 돈까스 : 돈까스는 일본의 대표적인 요리 중 하나로, 튀긴 돼지고기에 소스를 뿌려 먹습니다.
    * 오코노미야키 : 오코노미야키는 일본의 팬케이크와 비슷한 음식으로, 야채, 고기, 해산물 등을 섞어 구워 먹습니다.
    * 타코야키 : 타코야키는 일본의 튀김 요리로, 밀가루 반죽에 다진 문어, 야채를 넣고 구운 것입니다.

    **도쿄의 쇼핑**
    * 긴자 : 긴자는 도쿄의 대표적인 쇼핑가로 명품 매장을 비롯한 다양한 상점이 밀집되어 있습니다.
    * 시부야 : 시부야는 도쿄의 트렌디한 쇼핑가로 패션 매장, 잡화점, 카페 등이 많이 있습니다.
    * 하라주쿠 : 하라주쿠는 도쿄의 젊은이들이 모이는 거리로 괴상한 패션과 팝 문화를 볼 수 있습니다.
    * 아사쿠사 : 아사쿠사는 도쿄의 전통적인 쇼핑가로 나카미세 상점가에서 다양한 기념품을 구입할 수 있습니다.
    * 신주쿠 : 신주쿠는 도쿄의 번화가로 백화점, 쇼핑몰, 전자상가 등이 많이 있습니다.

    **이 일정은 다음과 같은 음식을 맛볼 수 있습니다.**

    * 초밥
    * 우동
    * 돈까츠
    * 라면
    * 규카츠
    * 오코노미야키
    * 몬자야끼
    * 타코야키
    * 이자카야

    **이 일정은 다음과 같은 쇼핑을 즐길 수 있습니다.**

    * 긴자
    * 시부야
    * 신주쿠
    * 아사쿠사
    * 하라주쿠
    * 오모테산도
    * 다이칸야마


    **1일차**
    나리타 국제공항(NRT) → 도쿄역 → 도쿄 스카이 트리 → 아사쿠사신사 → 아사쿠사 → 시부야 → 신주쿠

    **2일차**
    신주쿠 → 하라주쿠 → 오모테산도 → 메이지 신궁 → 신주쿠 교엔 국립 정원 → 신주쿠 → 도쿄 디즈니랜드 또는 도쿄 디즈니씨

    **3일차**
    신주쿠 → 롯폰기 힐즈 → 기념품점 → 신주쿠

    **4일차**
    신주쿠 → 도쿄역 → 나리타 국제공항(NRT)


    **도쿄 여행 키워드**

    나리타 국제공항(NRT) → 도쿄역 → 도쿄 스카이 트리 → 아사쿠사신사 → 아사쿠사 → 시부야 → 신주쿠 → 하라주쿠 → 오모테산도 → 메이지 신궁 → 신주쿠 교엔 국립 정원 → 도쿄 디즈니랜드 또는 도쿄 디즈니씨 → 롯폰기 힐즈 → 기념품점

        """]
      },
      {
        "role": "user",
        "parts": ["유명 관광지 쇼핑 위주의 오사카 4박5일 일정을 짜줘. 01~02월 사이로. 위 가이드 라인 대로."]
      },
      {
        "role": "model",
        "parts": [""" 

        ***1일차**
        * 오전: 나리타 국제공항(NRT)에 도착하여 나리타 익스프레스 기차로 도쿄역으로 이동합니다. (1시간 30분, 3,020엔)
        * 오후: 도쿄역에서 도쿄 메트로 지하철로 도쿄 스카이 트리역으로 이동합니다. (30분, 210엔)
        * 도쿄 스카이 트리에서 도쿄의 전경을 감상합니다.
        * 도쿄 스카이 트리에서 도쿄 메트로 지하철로 아사쿠사역으로 이동합니다. (30분, 210엔)
        * 아사쿠사 신사와 나카미세 상점가를 방문합니다.
        * 저녁: 아사쿠사에서 저녁 식사를 합니다.
        * 아사쿠사에서 도쿄 메트로 지하철로 시부야역으로 이동합니다. (30분, 210엔)
        * 시부야에서 밤거리를 즐깁니다.
        * 시부야에서 도쿄 메트로 지하철로 신주쿠역으로 이동합니다. (15분, 170엔)
        * 신주쿠에서 호텔로 이동합니다.
     ***2일차**
        * 신주쿠에서 도쿄 메트로 지하철로 도쿄역으로 이동합니다. (15분, 170엔)
        * 도쿄역에서 도쿄 디즈니랜드 또는 도쿄 디즈니씨로 이동합니다. (1시간, 2,000엔)
        * 도쿄 디즈니랜드 또는 도쿄 디즈니씨에서 즐거운 시간을 보냅니다.
        * 도쿄 디즈니랜드 또는 도쿄 디즈니씨에서 도쿄역으로 이동합니다. (1시간, 2,000엔)
        * 도쿄역에서 호텔로 이동합니다.
     ***3일차**
        * 오전: 신주쿠에서 도쿄 메트로 지하철로 롯폰기역으로 이동합니다. (15분, 170엔)
        * 롯폰기 힐즈에서 도쿄의 야경을 감상합니다.
        * 오후: 롯폰기에서 도쿄 메트로 지하철로 기념품점이 많은 지역을 방문합니다. (30분, 210엔)
        * 기념품을 사기 위해 기프트샵을 방문합니다.
        * 저녁: 기념품점에서 도쿄 메트로 지하철로 신주쿠역으로 이동합니다. (30분, 210엔)
        * 신주쿠에서 저녁 식사를 합니다.
        * 신주쿠에서 호텔로 이동합니다.
     ***4일차**
        * 오전: 신주쿠에서 도쿄 메트로 지하철로 도쿄역으로 이동합니다. (15분, 170엔)
        * 도쿄역에서 나리타 익스프레스 기차로 나리타 국제공항(NRT)으로 이동합니다. (1시간 30분, 3,020엔)
        * 나리타 국제공항(NRT)에서 귀국합니다.

    도쿄 여행 팁

    * 도쿄는 대중교통이 잘 발달되어 있으므로 지하철이나 버스를 이용하면 편리하게 이동할 수 있습니다.
    * 도쿄는 물가가 비싸므로 예산을 잘 짜고 여행하는 것이 좋습니다.
    * 도쿄는 관광객이 많은 도시이므로 소지품을 잘 관리하는 것이 중요합니다.
    * 도쿄는 영어가 통하지 않는 경우가 많으므로 간단한 일본어를 배우고 가는 것이 좋습니다.

    **도쿄 이동 방법에 대한 팁**
    * 도쿄와 나리타 국제공항간 이동 : 나리타 익스пресс, 시티 라이너, 공항 림진버스를 이용할 수 있습니다.
    * 도쿄 이동 : 도쿄 도심의 주요 이동 수단은 철도, 지하철, 버스입니다. 티켓은 대부분 무인 매표기에 판매합니다. 
    * 환승 표나 패스는 티켓 센터에서 구매할 수 있습니다.
    * 패스는 1, 2, 3일 이용권이 있습니다. 1일 이용권은 1,590엔, 2일 이용권은 2,000엔, 3일 이용권은 2,500엔입니다.
    * 패스는 도쿄 도내의 모든 철도, 지하철, 버스, 도쿄만 페리를 이용할 수 있습니다.

    **도쿄의 인기 관광 명소**
    * 도쿄 타워 : 일본 최고층의 타워로 현재는 전파탑으로 쓰이고 있습니다.
    * 도쿄 디즈니랜드와 도쿄 디즈니씨 : 전 세계적으로 유명한 테마파크입니다.
    * 오다이바 : 도쿄 만에 있는 인공 섬으로 트렌디한 쇼핑몰, 레스토랑, 엔터테인먼트 시설이 있는 인기 관광 명소입니다.
    * 아사쿠사 : 도쿄의 전통적인 지역으로 나카미세 상점가, 센소지, 아사쿠사 아지마마루 쇼핑가 등이 있습니다.
    * 시부야 : 도쿄의 패션과 유흥의 중심지로 109 백화점, 하라주쿠 쇼핑가, 시부야 스크램블 교차로 등이 있습니다.
    * 신주쿠 : 도쿄의 번화가로 신주쿠 고라쿠엔, 도쿄 메트로폴리탄 정원, 신주쿠 황금가 등이 있습니다.

    **도쿄의 맛있는 음식**
    * 스시 : 도쿄는 세계적으로 유명한 스시의 본고장입니다. 츠키지 시장을 비롯한 도쿄 곳곳에서 신선한 스시를 맛볼 수 있습니다.
    * 라멘 : 라멘은 일본의 국민 음식 중 하나로, 도쿄에는 다양한 종류의 라멘집이 있습니다.
    * 돈까스 : 돈까스는 일본의 대표적인 요리 중 하나로, 튀긴 돼지고기에 소스를 뿌려 먹습니다.
    * 오코노미야키 : 오코노미야키는 일본의 팬케이크와 비슷한 음식으로, 야채, 고기, 해산물 등을 섞어 구워 먹습니다.
    * 타코야키 : 타코야키는 일본의 튀김 요리로, 밀가루 반죽에 다진 문어, 야채를 넣고 구운 것입니다.

    **도쿄의 쇼핑**
    * 긴자 : 긴자는 도쿄의 대표적인 쇼핑가로 명품 매장을 비롯한 다양한 상점이 밀집되어 있습니다.
    * 시부야 : 시부야는 도쿄의 트렌디한 쇼핑가로 패션 매장, 잡화점, 카페 등이 많이 있습니다.
    * 하라주쿠 : 하라주쿠는 도쿄의 젊은이들이 모이는 거리로 괴상한 패션과 팝 문화를 볼 수 있습니다.
    * 아사쿠사 : 아사쿠사는 도쿄의 전통적인 쇼핑가로 나카미세 상점가에서 다양한 기념품을 구입할 수 있습니다.
    * 신주쿠 : 신주쿠는 도쿄의 번화가로 백화점, 쇼핑몰, 전자상가 등이 많이 있습니다.

    **이 일정은 다음과 같은 음식을 맛볼 수 있습니다.**

    * 초밥
    * 우동
    * 돈까츠
    * 라면
    * 규카츠
    * 오코노미야키
    * 몬자야끼
    * 타코야키
    * 이자카야

    **이 일정은 다음과 같은 쇼핑을 즐길 수 있습니다.**

    * 긴자
    * 시부야
    * 신주쿠
    * 아사쿠사
    * 하라주쿠
    * 오모테산도
    * 다이칸야마


    **1일차**
    나리타 국제공항(NRT) → 도쿄역 → 도쿄 스카이 트리 → 아사쿠사신사 → 아사쿠사 → 시부야 → 신주쿠

    **2일차**
    신주쿠 → 하라주쿠 → 오모테산도 → 메이지 신궁 → 신주쿠 교엔 국립 정원 → 신주쿠 → 도쿄 디즈니랜드 또는 도쿄 디즈니씨

    **3일차**
    신주쿠 → 롯폰기 힐즈 → 기념품점 → 신주쿠

    **4일차**
    신주쿠 → 도쿄역 → 나리타 국제공항(NRT)


    **도쿄 여행 키워드**

    나리타 국제공항(NRT) → 도쿄역 → 도쿄 스카이 트리 → 아사쿠사신사 → 아사쿠사 → 시부야 → 신주쿠 → 하라주쿠 → 오모테산도 → 메이지 신궁 → 신주쿠 교엔 국립 정원 → 도쿄 디즈니랜드 또는 도쿄 디즈니씨 → 롯폰기 힐즈 → 기념품점

    """]},

      {"role": "user",
        "parts": ["01~02월 쇼핑  오사카  5박6일 일정을 짜줘. 위 가이드 라인 대로 똑같이 만들어줘. 마지막에 모든 명소를 한줄로 출력해줘."]
      },
      {
        "role": "model",
        "parts": [""" 

**오사카 쇼핑 5박6일 일정**

**1일차**

* 오전: 간사이 국제공항(KIX)에 도착하여 하루카 익스프레스 기차로 신오사카역으로 이동합니다. (30분, 3,030엔)
* 오후: 신오사카역에서 오사카 메트로 지하철로 난바역으로 이동합니다. (30분, 280엔)
* 난바에서 쇼핑을 즐깁니다. 난바는 도톤보리, 난바 워크, 난바 시티 등 쇼핑몰과 상점이 밀집된 지역입니다.
* 저녁: 난바에서 저녁 식사를 합니다. 난바에는 다양한 종류의 레스토랑이 있습니다.

**2일차**

* 오전: 난바역에서 오사카 메트로 지하철로 우메다역으로 이동합니다. (30분, 280엔)
* 우메다에서 쇼핑을 즐깁니다. 우메다는 다이마루, 한큐 백화점, HEP FIVE 등 쇼핑몰과 상점이 밀집된 지역입니다.
* 오후: 우메다에서 오사카 메트로 지하철로 신사이바시역으로 이동합니다. (15분, 210엔)
* 신사이바시에서 쇼핑을 즐깁니다. 신사이바시는 긴자 상점가, 신사이바시 센터 가이드,  Amerikamura 등 쇼핑몰과 상점이 밀집된 지역입니다.
* 저녁: 신사이바시에서 저녁 식사를 합니다. 신사이바시에는 다양한 종류의 레스토랑이 있습니다.

**3일차**

* 오전: 신사이바시역에서 오사카 메트로 지하철로 혼마치역으로 이동합니다. (15분, 210엔)
* 혼마치에서 쇼핑을 즐깁니다. 혼마치는 긴테쓰 백화점, 다카시마야 백화점 등 쇼핑몰과 상점이 밀집된 지역입니다.
* 저녁: 혼마치에서 저녁 식사를 합니다. 혼마치에는 다양한 종류의 레스토랑이 있습니다.

**4일차**

* 오전: 난바역에서 오사카 메트로 지하철로 아베노하루카스역으로 이동합니다. (30분, 280엔)
* 아베노하루카스에서 쇼핑을 즐깁니다. 아베노하루카스는 일본에서 가장 높은 빌딩으로, 그 안에 백화점과 다양한 상점이 들어서 있습니다.
* 오후: 아베노하루카스에서 오사카 메트로 지하철로 덴노지역으로 이동합니다. (15분, 210엔)
* 덴노지에서 쇼핑을 즐깁니다. 덴노지는 덴노지 백화점, 미오 덴노지, 아베노 큐브 등 쇼핑몰과 상점이 밀집된 지역입니다.
* 저녁: 덴노지에서 저녁 식사를 합니다. 덴노지에는 다양한 종류의 레스토랑이 있습니다.

**5일차**

* 오전: 난바역에서 오사카 메트로 지하철로 센바역으로 이동합니다. (30분, 280엔)
* 센바에서 쇼핑을 즐깁니다. 센바는 호텔 뉴 오타니 오사카, 리츠칼튼 오사카, 콘래드 오사카 등 고급 호텔이 밀집된 지역입니다. 또한, 센바에는 다양한 상점과 레스토랑이 있습니다.
* 저녁: 센바에서 저녁 식사를 합니다. 센바에는 다양한 종류의 레스토랑이 있습니다.

**6일차**

* 오전: 신오사카역에서 하루카 익스프레스 기차로 간사이 국제공항(KIX)으로 이동합니다. (30분, 3,030엔)
* 간사이 국제공항(KIX)에서 귀국합니다.

**오사카 쇼핑 팁**

* 오사카는 대중교통이 잘 발달되어 있으므로 지하철이나 버스를 이용하면 편리하게 이동할 수 있습니다.
* 오사카는 물가가 비싸므로 예산을 잘 짜고 여행하는 것이 좋습니다.
* 오사카는 관광객이 많은 도시이므로 소지품을 잘 관리하는 것이 중요합니다.
* 오사카는 영어가 통하지 않는 경우가 많으므로 간단한 일본어를 배우고 가는 것이 좋습니다.

**오사카 이동 방법에 대한 팁**

* 간사이 국제공항(KIX)와 오사카간 이동 : 하루카 익스프레스, 난카이 전철, 공항 림진버스를 이용할 수 있습니다.
* 오사카 이동 : 오사카 도심의 주요 이동 수단은 철도, 지하철, 버스입니다. 티켓은 대부분 무인 매표기에 판매합니다.
* 환승 표나 패스는 티켓 센터에서 구매할 수 있습니다.
* 패스는 1, 2, 3일 이용권이 있습니다. 1일 이용권은 800엔, 2일 이용권은 1,200엔, 3일 이용권은 1,500엔입니다.
* 패스는 오사카 도내의 모든 철도, 지하철, 버스를 이용할 수 있습니다.

**오사카의 인기 관광 명소**

* 오사카 성 : 오사카의 상징적인 건축물로, 도요토미 히데요시가 축성했습니다.
* 통천각 : 오사카의 전통적인 랜드마크로, 1956년에 지어졌습니다.
* 아베노하루카스 : 일본에서 가장 높은 빌딩으로, 2014년에 완공되었습니다.
* 도톤보리 : 오사카의 번화가로, 다양한 레스토랑과 상점이 밀집되어 있습니다.
* 신사이바시 : 오사카의 쇼핑가로, 다양한 백화점과 상점이 밀집되어 있습니다.
* 덴노지 : 오사카의 관광지로, 덴노지 사원과 덴노지 동물원이 있습니다.

**오사카의 쇼핑**

* 난바 : 난바는 오사카의 번화가로, 다양한 백화점과 상점이 밀집되어 있습니다.
* 우메다 : 우메다는 오사카의 쇼핑가로, 다양한 백화점과 상점이 밀집되어 있습니다.
* 신사이바시 : 신사이바시는 오사카의 쇼핑가로, 다양한 백화점과 상점이 밀집되어 있습니다.
* 돈키호테 : 돈키호테는 일본의 할인점으로, 다양한 상품을 저렴한 가격에 판매합니다.
* 아카시야 : 아카시야는 오사카의 전통적인 쇼핑가로, 다양한 상점과 레스토랑이 밀집되어 있습니다.
        
    **오사카 여행 키워드**

    간사이 국제공항(KIX) → 도톤보리 → 난바 워크 → 난바 시티 → 다이마루 → 한큐 → HEP FIVE → 긴자 상점 → 신사이바시 센터 → Amerikamaru → 긴테쓰 백화점 → 다카시마야 백화점 → 아베노하루카스 → 덴노지 백화점 → 아베노 큐브 -> 호텔 뉴 오타니 오사카 → 리츠칼튼 오사카 → 콘래드 오사카 
                  

    """]},

    ])

    month1 = date_Departure.split("-")
    month2 = date_Arrival.split("-")

    convo.send_message(f"{month1[1]}~{month2[1]}월 {travel_type} {city}  {date_day - 1}박{date_day}일 일정을 상세하게 짜줘. 모든 상호명을 일정에 포함시켜줘. 무조건 마지막 줄엔 모든 여행 키워드가 한줄에 포함되어야 돼. 무조건 한국어로 해.")

    response = convo.last.text

    return response
    

def make_travel_plan(travel_type,city,date_Arrival,date_Departure,date_day):
    
    my_types = ""

    for i in travel_type:
        my_types = my_types + str(i) +  " "

    url_list = find_bolgs(my_types,city,date_day)
    response = generate_model(my_types,city,date_Arrival,date_Departure,date_day)

    date_Arrival_format = date_Arrival.split("-")
    date_Arrival_format = date_Arrival_format[0] + date_Arrival_format[1] + date_Arrival_format[2]

    date_Departure_format = date_Departure.split("-")
    date_Departure_format = date_Departure_format[0] + date_Departure_format[1] + date_Departure_format[2]

    country_codes = """GMP	김포 (GIMPO)
ICN	인천 (INCHEON)
CJU	제주 (JEJU)
TAE	대구 (DAEGU)
USN	울산 (ULSAN)
CJJ	청주 (CHEONGJU)
WJU	원주 (WONJU)
YNY	양양 (YANGYANG)
MWX	무안 (MUAN)
KWJ	광주 (GWANGJU)
RSU	여수 (YEOSU)
KPO	포항 (POHANG)
KUV	군산 (GUNSAN)
ANC	앵커리지 (ANCHORAGE)
ATL	애틀란타 (ATLANTA)
BOS	보스턴 (BOSTON)
BUE	부에노스아이레스 (BUENOS AIRES)
CHI	시카고 (CHICAGO)
CVG	신시내티 (CINCINNATI)
DEN	덴버 (DENVER)
DFW	댈러스 댈러스포트워스 (DALLAS FORT WORTH)
DTW	디트로이트 (DETROIT)
FAI	페어뱅크스 (FAIRBANKS)
GIG	리우데자네이루 갈레앙 (RIO DE JANEIRO)
GUM	괌 (GUAM)
HNL	호놀룰루 (HONOLULU)
HOU	휴스턴 (HOUSTON)
LAX	로스앤젤레스 (LOS ANGELES)
MCO	올랜도 (ORLANDO)
MEX	멕시코시티 (MEXICO JUAREZ INTE)
MIA	마이애미 (MIAMI)
MSP	미니애폴리스 크리스탈 (MINNEAPOLIS CRYSTAL)
MSY	뉴올리언스 암스트롱 (NEW ORIEANS)
NYC	뉴욕 (NEW YORK)
PDX	포틀랜드 (PORTLAND)
PHL	필라델피아 (PHILADELPHIA)
SEA	시애틀 (SEATTLE)
SAO	상파울루 (SAO PAULO)
SFO	샌프란시스코 (SAN FRANCISCO)
SAN	샌디에이고 (SAN DIEGO)
WAS	워싱턴 (WASHINGTON)
YEG	에드먼턴 (EDMONTON)
YMX	몬트리올 (MONTREAL)
YTO	토론토 (TORONTO)
YVR	밴쿠버 (VANCOUVER)
AOJ	아오모리 (AOMORI)
FUK	후쿠오카 (FUKUOKA)
HIJ	히로시마 (HIROSHIMA)
HND	하네다 (HANEDA)
KIJ	니가타 (NIIGATA)
KKJ	키타큐슈 (KITA KYUSHU)
KMJ	구마모토 (KUMAMOTO)
KMQ	고마쓰 (KOMATSU)
KOJ	가고시마 (KAGOSHIMA)
MYJ	마쓰야마 (MATSUYAMA)
NGO	나고야 (NAGOYA)
NGS	나가사키 (NAGASAKI)
NRT	도쿄/나리타 (TOKYO/NARITA)
OIT	오이타 (OITA)
OKJ	오카야마 (OKAYAMA)
OSA	오사카 (OSAKA)
SDJ	센다이 (SENDAI)
SPK	삿포로 (SAPPORO)
SYO	쇼나이 (SYONAI)
TAK	다카마쓰 (TAKAMATSU)
TOY	도야마 (TOYAMA)
TTJ	돗토리 (TOTTORI)
PEK	베이징 (BEIJING)
CAN	광저우 (GUANGZHOU)
CGQ	창춘 (CHANGCHUN)
DLC	다롄 (DALIAN)
HRB	하얼빈 (HARBIN)
TAO	칭다오 (QINGDAO)
SHA	푸동 (PUDONG)
TSN	톈진 (TIANJIN)
SHE	선양 (SHENYANG)
XMN	샤먼 (XIAMEN)
YNT	옌타이 (YANTAI)
SIA	시안 (XIANYANG)
KMG	쿤밍 (KUNMING)
SYX	싼야 (SANYA)
WUH	우한 (WUHAN)
YNJ	옌지 (YANJI)
WEH	웨이하이 (WEIHAI)
AUH	아부다비 (ABU DHABI)
BAH	바레인 (BAHRAIN)
BGW	바그다드 (BAGHDAD)
CAI	카이로 (CAIRO)
DXB	두바이 (DUBAI)
JED	제다 (JEDDAH)
KWI	쿠웨이트 (KUWAIT)
RUH	리야드 (RIYADH)
THR	테헤란 (TEHERAN)
TIP	트리폴리 (TRIPOLI)
TLV	텔아비브 (TEL AVIV)
ALA	알마티 (ALMATY)
BKI	코타키나발루 (KOTAKINABALU)
BKK	방콕/수완나품 (BANGKOK)
BOM	뭄바이 (MUMBAI)
CCU	캘거타 (CALCUTTA)
CMB	콜롬보 (COLOMBO)
DEL	델리 (DELHI)
DPS	덴파사르 (DENPARSAR)
HAN	하노이 (HANOI)
HKG	홍콩 (HONG KONG)
HKT	푸켓 (PHUKET)
JKT	자카르타 (JAKARTA)
KCH	쿠칭 (KUCHING)
KUL	쿠알라룸푸르 (KUALA LUMPUR)
KHH	가오슝 (KAOHSIUNG)
MNL	마닐라 (MANILA)
PEN	페낭 (PENANG)
SGN	호치민 (HO CHI MINH)
SIN	싱가포르 (SINGAPORE)
TAS	타슈켄트 (TASHKENT)
TPE	타이베이 (TAIPEI)
ULN	울란바토르 (ULAANBAATAR)
AMS	암스테르담 (AMSTERDAM)
ATH	아테네 (ATHENS)
BCN	바르셀로나 (BARCELONA)
BER	베를린 (BERLIN)
BRU	브뤼셀 (BRUSSELS)
CGN	쾰른 (COLOGNE)
CPH	코펜하겐 (COPENHAGEN)
FRA	프랑크푸르트 (FRANKFURT)
GVA	제네바 (GENEVA)
HEL	헬싱키 (HELSINKI)
HAM	함부르크 (HAMBURG)
KHV	하바롭스크 (KHABAROVSK)
KJA	크라스노야르스크 (KRASNOYARSK)
LON	런던시티 (LONDON CITY)
LUX	룩셈부르크 (LUXEMBOURG)
MAD	마드리드 (MADRID)
MOW	모스크바 (MOSCOW)
PAR	파리/오를리 (PARIS/ORLY)
ROM	로마 (ROME)
SOF	소피아 (BULGARIA)
STO	스톡홀름 (STOCKHOLM)
VVO	블라디보스토크 (VLADIVOSTOK)
ZRH	취리히 (ZURICH)
AKL	오클랜드 (AUCKLAND)
BNE	브리즈번 (BRISBANE)
CHC	크라이스트처치 (CHRISTCHURCH)
CNS	케언스 (CAIRNS)
SYD	시드니 (SYDNEY)
NAN	난디 (NANDI)
JFK	뉴욕 JOHN F KENNEDY
CDG	파리 CHARLES DE GAULLE
NRT	도쿄 NARITA
HND 도쿄 HANEDA
KIX	오사카 KANSAI
"""

    country_codes = country_codes.split("\n")

    country_codes = [word for word in country_codes if f"{city}" in word]

    country_codes = country_codes[0]

    country_codes = str(country_codes).split("\t")

    print(country_codes)

    country_codes = country_codes[0]


    url = f"https://skyscanner.co.kr/transport/flights/sela/{country_codes}/{date_Departure_format}/{date_Arrival_format}/"

    return response,url_list,url

